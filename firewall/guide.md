## 使用指南

### 推荐防火墙

为了给用户提供使用上的便捷，控制台上提供了两个默认的"推荐防火墙"，分别是"Web服务器推荐"与"非Web服务器推荐"，两者之间除"Web服务器推荐"默认开通了"80、443"端口外，均录入了"22、3389"端口。

防火墙默认规则除已开通端口外，其他端口默认关闭。

默认防火墙规则不可修改，但可从默认防火墙详情页点击“复制”，新建相同规则自定义防火墙进行修改。

**注意：**

外网防火墙仅对来自外网的弹性IP的访问生效。

### 防火墙基本功能

#### 创建防火墙

在控制台中点击创建防火墙，填入防火墙名称及备注，即可进入规则添加页面。在规则添加页面点击“添加规则”，并选择相应的协议，依次填入“端口”、“源地址”、“动作”、“优先级”以及备注（非必填）后，点击保存完成最基本的创建流程。
**注意：**

"推荐防火墙"不支持修改，但可将自推荐防火墙修改内容另存为用户自定义防火墙。

![image](/images//firewall1.png)

#### 编辑防火墙规则

**注意：**

防火墙除已录入条目外，默认对其他访问执行**拒绝**动作。

1.协议

目前防火墙协议支持“TCP”、“UDP”、“ICMP”及“GRE”协议。

2.端口

来源地址所访问的本地端口，端口范围 \[1-65535\]。

3.源地址

访问云平台主机资源的网络数据包来源地址，支持IP地址及网段，IP地址网段间用逗号分割（支持IP及网段数量≤10），例如"10.0.0.1,192.168.0.2/32"。

4.动作

防火墙生效时，对数据包的处理行为，包含“接受、“拒绝”两种动作。

5.优先级

在防火墙内添加规则时，规则按照优先级依次生效，每条规则包含“高”、“中”、“低”三档规则。

6.备注（非必填）

可对每一条规则添加备注，便于规则的管理和查找。

![image](/images/编辑规则.png)

7.防火墙规则限制：

防火墙不支持存在重复的规则，协议、端口、源地址、动作重复则判断为规则重复。存在重复规则会导致操作报错。

若已经存在重复规则解决办法参考如下：

**同时**删除所有重复规则，重新提交请求。

![image](/images/防火墙规则批量删除.png)

单击"快捷规则"下拉框，可以看到各种常用协议。

协议说明：

  - **基本协议包含：** 
  
      （1）指定TCP：用户自定义TCP协议端口 
  
      （2）指定UDP：用户自定义UDP协议端口 
  
      （3）全端口TCP：所有TCP端口
    
      （4）全端口UDP：所有UDP端口 
    
      （5）GRE：GRE协议
  
      （6）ICMP：ICMP协议
  
  - **快捷规则包含：** 
  
     （1）FTP：TCP 21端口 
   
     （2）HTTP：TCP 80端口 
  
     （3）HTTPS：TCP 443端口 
  
     （4）PING：ICMP协议
  
     （5）OpenVPN：UDP 1194端口 
  
     （6）PPTP：TCP 1723端口 
  
     （7）RDP：TCP 3389端口 
  
     （8）SSH：TCP 22端口

#### 删除防火墙规则

防火墙规则支持单条规则删除，也支持批量删除。

**注意：**

防火墙至少需要保留一条规则，因为全选时“删除”按钮不可用。

#### 复制防火墙

复制防火墙能够复制防火墙除自身属性之外的所有规则内容，适用于在原防火墙基础上添加新规则时使用。

#### 绑定资源批量管理

进入"资源概览"界面，可以对已经绑定所选防火墙的云主机、物理云主机资源进行批量更改防火墙。

- 点击更换防火墙按钮

![image](/images/firewall3.png)

- 选中所需要更换所绑定防火墙的资源

![image](/images/firewall4.png)

- 选择所需要更换的防火墙

![image](/images/firewall5.png)
